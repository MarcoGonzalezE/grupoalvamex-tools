<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>
		<record id="fleet_vehicle_form_view" model="ir.ui.view">
			<field name="name">fleet.vehicle.form</field>
			<field name="model">fleet.vehicle</field>
			<field name="inherit_id" ref="fleet.fleet_vehicle_view_form"/>
			<field name="arch" type="xml">
				<xpath expr="//header" position="inside">
					<button name="assign_vehicle" type="object" class="btn-primary" string="Asignar" attrs="{'invisible':[('employee_id','!=', False)]}"/>
					<button name="return_vehicle" type="object" class="btn-primary" string="Devolucion" attrs="{'invisible':[('employee_id','=', False)]}"/>
				</xpath>
				<field name="driver_id" position="after">
					<label for='employee_id'/>
					<div name="employee_div" class="o_row">
						<field name="employee_id" options="{'no_quick_create': true,'no_create ': True, 'no_create_edit' : True}" readonly="1"/>
						<br/>
						<strong><field name="license_state"/></strong>
					</div>
					<field name="date_assign"/>
					<field name="assign_id" invisible="1"/>
				</field>
				<xpath expr="//sheet" position="inside">
					<group string="Asignaciones">
						<field name="vehicle_assign">
							<tree string="Asignaciones" editable="top">
								<field name="employee_id" options="{'no_quick_create': true,'no_create ': True, 'no_create_edit' : True}"/>
								<field name="driver_job"/>
								<field name="date_assign"/>
								<field name="date_return"/>
								<field name="note"/>
							</tree>
						</field>
					</group>
				</xpath>
			</field>
		</record>

		<record id="fleet_vehicle_assignments_view_form" model="ir.ui.view">
			<field name="name">fleet.vehicle.assignments.form</field>
			<field name="model">fleet.vehicle.assignments</field>
			<field name="arch" type="xml">
				<form>
					<group>
						<field name="vehicle_id" readonly="1"/>
						<field name="employee_id" domain="[('driver','=',True)]" options="{'no_quick_create': true,'no_create ': True, 'no_create_edit' : True}"/>
						<field name="driver_job"/>
						<field name="date_assign"/>
						<field name="note"/>
					</group>
					<footer>
						<button name="assign_vehicle" type="object" class="btn-primary" string="Asignar"/>
						<button string="Cancelar" class="btn-default" special="cancel"/>
					</footer>
				</form>
			</field>
		</record>

		<record id="fleet_vehicle_return_view_form" model="ir.ui.view">
			<field name="name">fleet.vehicle.return.form</field>
			<field name="model">fleet.vehicle.assignments</field>
			<field name="arch" type="xml">
				<form>
					<group>
						<field name="vehicle_id" readonly="1"/>
						<field name="employee_id" readonly="1"/>
						<field name="driver_job" readonly="1"/>
						<field name="date_assign" readonly="1"/>
						<field name="date_return"/>
						<field name="note"/>
					</group>
					<footer>
						<button name="save" type="object" class="btn-primary" string="Guardar"/>
						<button string="Cancelar" class="btn-default" special="cancel"/>
					</footer>
				</form>
			</field>
		</record>

		<record id="fleet_vehicle_kanban_view" model="ir.ui.view">
			<field name="name">fleet.vehicle.kanban.view</field>
			<field name="model">fleet.vehicle</field>
			<field name="inherit_id" ref="fleet.fleet_vehicle_view_kanban"/>
			<field name="arch" type="xml">
				<xpath expr="//ul" position="inside">
					<li>
						<t t-if="record.employee_id.raw_value"><field name="employee_id"/></t>						
					</li>
					<li>
						<t t-if="record.license_state.raw_value">
							<strong>
								<font color="green" attrs="{'invisible':[('license_state','!=', 'activa')]}">
									<field name="license_state"/>
								</font>
								<font color="red" attrs="{'invisible':[('license_state','!=','inactiva')]}">
									<field name="license_state"/>
								</font>
								<font color="orange" attrs="{'invisible':[('license_state','!=', 'pendiente')]}">
									<field name="license_state"/>
								</font>
							</strong>
						</t>
					</li>
				</xpath>
			</field>
		</record>


		<record id="fleet_hr_employee_view_form" model="ir.ui.view">
			<field name="name">fleet.hr.employee.form</field>
			<field name="model">hr.employee</field>
			<field name="inherit_id" ref="hr.view_employee_form"/>
			<field name="arch" type="xml">
				<notebook position="inside">
					<page string="Flota">
						<group>
							<group>
								<field name="driver"/>
								<field name="driver_license" attrs="{'required':[('driver','=',True)], 'invisible':[('driver','=',False)]}"/>
								<field name="license_valid" attrs="{'invisible':[('driver','=',False)]}"/>
							</group>
							<group>
								<field name="days_expire" attrs="{'invisible':[('driver','=',False)]}"/>
								<field name="license_type" attrs="{'invisible':[('driver','=',False)]}"/>
								<field name="license_expiration" attrs="{'invisible':[('driver','=',False)]}"/>
							</group>
						</group>
					</page>
				</notebook>
			</field>
		</record>
	</data>
</odoo>