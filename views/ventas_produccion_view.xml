<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!--- Action-->
        <record id="ventas_produccion_action" model="ir.actions.act_window">
            <field name="name">Planeacion</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ventas.produccion</field>
            <field name="view_mode">tree,form,graph</field>
        </record>

        <!--- Tree -->
        <record id="boton_produccion_tree" model="ir.ui.view">
            <field name="name">ventas.produccion.tree.view</field>
            <field name="model">ventas.produccion</field>
            <field name="arch" type="xml">
                <tree string="Plaeacion de Produccion"
                      colors="red:estado=='cancel'; navy:estado =='final' ; teal:estado=='aceptado';">
                    <field name="name"/>
                    <field name="fecha_pedido"/>
                    <field name="cliente"/>
                    <field name="sucursal"/>
                    <field name="estado"/>
                </tree>
            </field>
        </record>

        <!--- Form -->
        <record id="ventas_produccion_form" model="ir.ui.view">
            <field name="name">Planeacion de Produccion</field>
            <field name="model">ventas.produccion</field>
            <field name="arch" type="xml">
                <form string="Planeacion"><!--edit="false"-->
                    <header>
                        <!-- <button string="VALIDAR SALIDA" type="object"  name="check_aprobado" attrs="{'invisible':['|',('enviado_pt','=',True),('estado','!=','aceptado')]}" groups="grupoalvamex_tools.planeacion_ventas"/><b/> -->
                        <!-- <button string="ENVIAR A PRODUCCION" type="object" class="oe_highlight" name="enviado" attrs="{'invisible':[('estado','!=','creado')]}" groups="grupoalvamex_tools.planeacion_ventas"/><b/> -->
                        <!-- <button string="ACEPTAR PEDIDO" type="object" class="oe_highlight" name="aceptado" groups="grupoalvamex_tools.planeacion_produccion" attrs="{'invisible':[('estado','!=','enviado')]}"/><b/> -->
                        <field name="estado" widget="statusbar" class="oe_highlight"/>
                        <button string="CONFIRMAR PEDIDO A PRODUCCION" type="object" class="oe_highlight" name="listo" attrs="{'invisible':['|',('estado','=','cancel'),('estado','=','final')]}"/><b/>
                        <!-- <button string="Comprobar disponibilidad" type="object" class="oe_highlight" name="comprobar" attrs="{'invisible':['|',('estado','=','cancel'),('estado','=','final')]}"/> -->
                        <button string="CANCELAR" type="object" class="btn" name="cancelado" attrs="{'invisible':[('estado','=','cancel')]}"/><b/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1><field name="name" readonly="1"/></h1>
                        </div>                        
                        <group>
                            <table width="100%">
                                <tr>
                                    <th>CEDIS</th>
                                </tr>
                                <tr>
                                    <td><field name="sucursal" options="{'no_create': True}" attrs="{'readonly':[('estado','!=','creado')]}" required="1"/></td>
                                </tr>
                                <tr>
                                    <th>Cliente</th>
                                    <th>Fecha de Pedido</th>
                                    <th>Fecha Inicio</th>
                                    <th>Fecha Aceptacion</th>
                                    <th>Fecha Terminacion</th>
                                </tr>
                                <tr>
                                    <td><field name="cliente" attrs="{'readonly':[('estado','!=','creado')]}" required="1"/></td>
                                    <td><field name="fecha_pedido" readonly="1"/></td>
                                    <td><field name="fecha_inicio" readonly="1"/></td>
                                    <td><field name="fecha_produccion" readonly="1"/></td>
                                    <td><field name="fecha_termino" readonly="1"/></td>
                                </tr>
                            </table>
                        </group>
                        <group>
                            <notebook>
                                <page string="Productos">
                                    <field name="producto" readonly="1">
                                        <tree>
                                            <field name="product_id"/>
                                            <field name="name"/>
                                            <field name="product_uom_qty" sum="Total"/>
                                            <field name="product_uom"/>
                                            <field name="order_id"/>
                                            <field name="state"/>
                                        </tree>
                                    </field>
                                </page>
                                <page string="Ventas">
                                    <field name="ventas_id" readonly="1"/>
                                </page>
                            </notebook>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <!-- Graph -->
        <record id="ventas_produccion_graph" model="ir.ui.view">
            <field name="name">Grafica Planeacion</field>
            <field name="model">ventas.produccion</field>
            <field name="arch" type="xml">
                <graph stacked="False">
                    <field name="sucursal" string="CEDIS"/>
                </graph>
            </field>
        </record>

<!---ACCION PARA ENVIAR A PLANEACION-->
        <record id="action_venta_produccion_form" model="ir.ui.view">
            <field name="name">Planear Produccion</field>
            <field name="model">ventas.produccion.planeacion</field>
            <field name="arch" type="xml">
                <form string="Crear orden de Planeacion">
                    <separator colspan="4" string="¿Crear orden de planeacion?"/>
                    <footer>
                        <button name="planeacion" string="Confirmar" type="object"/>
                        <button class="oe_link" special="cancel" string="Cancelar"/>
                    </footer>
                </form>
            </field>
        </record>
        <act_window id="action_venta_planeacion_produccion" key2="client_action_multi" name="Crear orden de Planeacion" res_model="ventas.produccion.planeacion" src_model="sale.order" target="new" view_mode="form"/>
        
        <!--Menus-->
        <menuitem name="Planeacion" id="menu_planeacion" sequence="25"
                  web_icon="grupoalvamex_tools,static/description/planeacion.png"/>
        <menuitem name="Planeacion" id="menu_produccion_planeacion" parent="menu_planeacion" action="ventas_produccion_action"
                  sequence="650"/>

                

<!-- Inventario Produccion -->
        <record id="ventas_produccion_inventario_view_form" model="ir.ui.view">
            <field name="name">ventas.produccion.inventario.form</field>
            <field name="model">ventas.produccion.inventario</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button type="object" name="registrar_entrada" string="Registrar Entrada" class="btn-primary"/>
                        <button type="object" name="actualizar_ventas" string="Actualizar Salidas" class="btn"/>
                    </header>
                    <sheet>                        
                        <div>
                            <field name="imagen" widget="image" class="oe_avatar"/>
                            <div class="oe_title">
                                <p>
                                    <h2><field name="name" placeholder="Producto" required="1"/></h2>
                                    <strong>CEDIS: </strong><field name="sucursal" required="1"/>
                                </p>
                            </div>
                            <group>
                                <table style="width:70%">
                                    <tr>
                                        <th style="text-align: center; width:30%;">Stock Minimo</th>
                                        <th style="text-align: center; width:30%;">Stock Faltante</th>
                                        <th style="font-size: 20px;">STOCK</th>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center; width:30%;"><field name="s_min"/></td>
                                        <td style="text-align: center;  width:30%;"><field name="s_fal" readonly="1"/></td>
                                        <td style="width:30%;"><field name="stock_total"/>
                                            <!-- <br/><field name="info" attrs="{'invisible':[('stock_total','&gt;', 0)]}"/> 
                                            - <field name="mensaje" style="color:red ! important;" attrs="{'invisible':[('s_min','&gt;','stock_total')]}" readonly="1"/> -->
                                            </td>
                                    </tr>
                                </table>
                            </group>
                        </div>
                        <group>
                            <notebook>
                                <page string="Entradas">
                                    <field name="entrada_ids">
                                        <tree editable="top">
                                            <field name="fecha_entrada" readonly="1"/>
                                            <field name="entrada_stock" readonly="1" sum="entradas"/>
                                            <field name="lote" readonly="1"/>
                                            <field name="nota" readonly="1"/>
                                        </tree>
                                    </field>
                                </page>
                                <page string="Salidas">
                                    <field name="ventas_ids" readonly="1">
                                        <tree>
                                            <field name="product_id"/>
                                            <field name="name"/>
                                            <field name="product_uom_qty" sum="Total"/>
                                            <field name="product_uom"/>
                                            <field name="order_id"/>
                                            <field name="state"/>
                                        </tree>
                                    </field>
                                </page>
                            </notebook>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="ventas_produccion_inventario_view_kandan" model="ir.ui.view">
            <field name="name">ventas.produccion.inventario.kanban.view</field>
            <field name="model">ventas.produccion.inventario</field>
            <field name="arch" type="xml">
                <kanban class="o_res_partner_kanban">
                    <field name="name"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_global_click">
                                <div class="o_kanban_image">
                                    <img t-att-src="kanban_image('ventas.produccion.inventario', 'imagen', record.id.value)"/>
                                </div>
                                <div class="oe_kanban_details">
                                    <strong class="oe_partner_heading"><field name="name"/></strong>
                                    <ul><font color="blue"><field name="sucursal"/></font></ul>
                                    <ul><strong>Stock: <field name="stock_total"/></strong></ul>
                                    <ul attrs="{'invisible':[('s_fal','=', 0)]}"><strong><font color="red">Faltante: <field name="s_fal"/></font></strong></ul>
                                    <ul attrs="{'invisible':[('s_fal','>', 0)]}"><strong>Faltante: <field name="s_fal"/></strong></ul>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
<!--- Pedido PT Tree -->
        <record id="pedido_pt_tree" model="ir.ui.view">
            <field name="name">ventas.produccion.inventario.tree.view</field>
            <field name="model">ventas.produccion.inventario</field>
            <field name="arch" type="xml">
                <tree string="Inventario Info" edit="false" create="false">
                    <field name="name"/>
                    <field name="sucursal"/>
                    <field name="s_min"/>
                    <field name="stock_total"/>
                    <field name="s_fal"/>
                </tree>
            </field>
        </record>


        <record id="ventas_produccion_inventario_action" model="ir.actions.act_window">
            <field name="name">Inventario</field>
            <field name="res_model">ventas.produccion.inventario</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="help" type="html">
                <p>No se encontro inventario</p>
            </field>
        </record>
        <record id="ventas_produccion_pedidopt_action" model="ir.actions.act_window">
            <field name="name">Inventario Info</field>
            <field name="res_model">ventas.produccion.inventario</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p>No se encontro inventario</p>
            </field>
        </record>

        <menuitem name="Inventario" id="menu_inventario" parent="menu_planeacion" action="ventas_produccion_inventario_action" sequence="660"/>
        <menuitem name="Inventario Info" id="menu_pedidopt" parent="menu_planeacion" action="ventas_produccion_pedidopt_action" sequence="661"/>

<!-- Sucursales -->
        <record id="sucursales_planeacion_view_tree" model="ir.ui.view">
            <field name="name">Centros de Distribución</field>
            <field name="model">sucursales.planeacion</field>
            <field name="arch" type="xml">
                <tree string="Centros de Distribución">
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <record id="sucursales_planeacion_view_form" model="ir.ui.view">
            <field name="name">Centros de Distribución</field>
            <field name="model">sucursales.planeacion</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="act_ventas" type="object" class="oe_stat_button" icon="fa-truck">
                                <div class="o_form_field o_stat_info">
                                    <span class="o_stat_value"><field name="ventas_cont"/></span>
                                    <span class="o_stat_text"> Ventas</span>
                                </div>
                            </button>
                            <button name="act_inventario" type="object" class="oe_stat_button" icon="fa-industry">
                                <div class="o_form_field o_stat_info">
                                    <span class="o_stat_value"><field name="inventario_cont"/></span>
                                    <span class="o_stat_text"> Productos</span>
                                </div>
                            </button>
                        </div>
                        <field name="imagen" widget="image" class="oe_avatar"/>
                        <div class='oe_title'>
                            <h2><field name="name"/></h2>
                        </div>                        
                    </sheet>
                </form>
            </field>
        </record>

        <record id="sucursales_planeacion_action" model="ir.actions.act_window">
            <field name="name">Centros de Distribución</field>
            <field name="res_model">sucursales.planeacion</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p>No se ha registrado ningun Centro de distribución</p>
            </field>
        </record>

        <menuitem name="Centros de Distribución" id="menu_cedis" parent="menu_planeacion" action="sucursales_planeacion_action" sequence="700" groups="grupoalvamex_tools.planeacion_gerencia"/>

<!-- Inventario Entrada -->
        <record id="inventario_entrada_view_form" model="ir.ui.view">
          <field name="name">inventario.entrada.form.view</field>
          <field name="model">inventario.entradas</field>
          <field name="arch" type="xml">
            <form>
                <group>
                    <field name="entrada_id" readonly="True"/>
                    <field name="entrada_stock"/>
                    <field name="lote"/>
                    <field name="fecha_entrada"/>
                </group>
                <group>
                    <field name="nota"/>
                </group>
                <footer>
                    <button string="Registrar" class="oe_highlight" name="save" type="object"/>
                    <button string="Cancelar" class="oe_highlight" special="cancel"/>
                </footer>
            </form>
          </field>
      </record>   

<!-- Vendedores -->
        <record id="ventas_vendedores_action" model="ir.actions.act_window">
            <field name="name">Agregar Vendedores</field>
            <field name="res_model">vendedores.ventas</field>
            <field name="view_mode">kanban,form</field>
        </record>

        <record id="vendedores_ventas_view_kandan" model="ir.ui.view">
            <field name="name">vendedores.ventas.kanban.view</field>
            <field name="model">vendedores.ventas</field>
            <field name="arch" type="xml">
                <kanban class="o_res_partner_kanban">
                    <field name="name"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_global_click">
                                <div class="o_kanban_image">
                                    <img t-att-src="kanban_image('vendedores.ventas', 'imagen', record.id.value)"/>
                                </div>
                                <div class="oe_kanban_details">
                                    <h4>
                                    <strong class="oe_partner_heading"><field name="name"/></strong>
                                    </h4>
                                    <br>
                                    <strong class="oe_partner_heading"><field name="correo"/></strong>
                                    </br>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record id="vendedores_ventas_view_form" model="ir.ui.view">
            <field name="name">vendedores.ventas.form</field>
            <field name="model">vendedores.ventas</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <div>
                            <field name="imagen" widget="image" class="oe_avatar"/>
                            <group>
                                <h1>
                                 <field name="name" placeholder="[Nombre del Vendedor]"/>
                                </h1>
                            </group>
                            <group>
                                <group>
                                    <field name="correo"/>
                                    <field name="tel" widget="phone"/>
                                </group>

                            </group>
                        </div>

                    </sheet>
                </form>
            </field>
        </record>

        <menuitem name="Agregar Vendedor" id="agregar_vendedor" parent="sales_team.menu_base_partner" action="ventas_vendedores_action" sequence="101"/>

        <record id="sale_order_inherit" model="ir.ui.view">
            <field name="name">sale.order.inherit</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <field name="partner_shipping_id" position="after">
                  <field name="vendedores"/>
                  <field name="es_promocion" string="Promoción"/>
                </field>
            </field>
        </record>
        
        <record id="res_partner_inherit" model="ir.ui.view">
            <field name="name">res.partner.inherit</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">
                <field name="category_id" position="after">
                    <group>
                  <field name="x_vendedores"/>
                    </group>
                </field>
            </field>
        </record>

    </data>
</odoo>